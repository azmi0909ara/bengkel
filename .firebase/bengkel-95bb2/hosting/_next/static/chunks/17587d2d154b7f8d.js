(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24571,a=>{"use strict";var e=a.i(43476),t=a.i(71645);a.i(36180);var s=a.i(98925),r=a.i(59141);function i(){let[i,l]=(0,t.useState)([]),[n,d]=(0,t.useState)(null),[c,o]=(0,t.useState)(null);(0,t.useEffect)(()=>{Promise.all([a.A(34162),a.A(98136)]).then(([a,e])=>{o({jsPDF:a.jsPDF,autoTable:e.default||e})})},[]),(0,t.useEffect)(()=>{(async()=>{let a=(await (0,s.getDocs)((0,s.collection)(r.db,"service"))).docs.map(a=>{let e=a.data();return{id:a.id,pelangganNama:e.pelangganNama||"",kendaraanLabel:e.kendaraanLabel||"",mekanikNama:e.mekanikNama||"",jenisServis:Array.isArray(e.jenisServis)?e.jenisServis:"string"==typeof e.jenisServis?[e.jenisServis]:[],sparepart:Array.isArray(e.sparepart)?e.sparepart:[],biayaServis:Number(e.biayaServis||0),totalSparepart:Number(e.totalSparepart||0),totalBayar:Number(e.totalBayar||0),status:e.status||""}});l(a),a.length>0&&d(a[0])})()},[]);let p=async()=>{if(!n)return;let a=(0,s.doc)(r.db,"service",n.id);await (0,s.updateDoc)(a,{status:"SELESAI"}),d({...n,status:"SELESAI"}),l(a=>a.map(a=>a.id===n.id?{...a,status:"SELESAI"}:a)),alert("Status service diperbarui menjadi SELESAI")};return(0,e.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black p-6 text-white",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Invoice Service"}),(0,e.jsx)("select",{className:"w-full bg-gray-800 border border-gray-700 rounded px-3 py-2 mb-6",value:n?.id||"",onChange:a=>{d(i.find(e=>e.id===a.target.value)||null)},children:i.map(a=>(0,e.jsxs)("option",{value:a.id,children:[a.pelangganNama," - ",a.kendaraanLabel," [",a.status,"]"]},a.id))}),n&&(0,e.jsxs)("div",{className:"bg-gray-900 border border-gray-700 rounded-xl p-6 space-y-4",children:[(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Pelanggan:"})," ",n.pelangganNama]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Kendaraan:"})," ",n.kendaraanLabel]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Mekanik:"})," ",n.mekanikNama]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Jenis Servis:"})," ",n.jenisServis.join(", ")]}),(0,e.jsxs)("p",{children:[(0,e.jsx)("strong",{children:"Status:"})," ",n.status]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"font-semibold mb-2",children:"Sparepart Digunakan:"}),0===n.sparepart.length?(0,e.jsx)("p",{className:"text-gray-400",children:"Tidak ada sparepart"}):(0,e.jsxs)("table",{className:"w-full text-sm text-left border border-gray-700 rounded",children:[(0,e.jsx)("thead",{className:"bg-gray-800 text-gray-300 uppercase text-xs",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-4 py-2",children:"Nama"}),(0,e.jsx)("th",{className:"px-4 py-2",children:"Harga"}),(0,e.jsx)("th",{className:"px-4 py-2",children:"Qty"}),(0,e.jsx)("th",{className:"px-4 py-2",children:"Subtotal"})]})}),(0,e.jsx)("tbody",{className:"divide-y divide-gray-700",children:n.sparepart.map((a,t)=>(0,e.jsxs)("tr",{className:"hover:bg-gray-800 transition",children:[(0,e.jsx)("td",{className:"px-4 py-2",children:a.nama}),(0,e.jsxs)("td",{className:"px-4 py-2",children:["Rp ",a.harga.toLocaleString("id-ID")]}),(0,e.jsx)("td",{className:"px-4 py-2",children:a.qty}),(0,e.jsxs)("td",{className:"px-4 py-2",children:["Rp ",(a.harga*a.qty).toLocaleString("id-ID")]})]},t))})]})]}),(0,e.jsxs)("div",{className:"bg-black/40 border border-gray-700 rounded p-4 text-sm",children:[(0,e.jsxs)("p",{children:["Biaya Servis: Rp ",n.biayaServis.toLocaleString("id-ID")]}),(0,e.jsxs)("p",{children:["Total Sparepart: Rp ",n.totalSparepart.toLocaleString("id-ID")]}),(0,e.jsxs)("p",{className:"text-lg font-bold text-red-500",children:["Total Bayar: Rp ",n.totalBayar.toLocaleString("id-ID")]})]}),(0,e.jsxs)("div",{className:"flex flex-col md:flex-row gap-3",children:[(0,e.jsx)("button",{className:"w-full bg-green-600 hover:bg-green-700 transition rounded py-2 font-semibold",onClick:p,children:"Tandai Selesai"}),(0,e.jsx)("button",{className:"w-full bg-red-600 hover:bg-red-700 transition rounded py-2 font-semibold",onClick:()=>{if(!n||!c)return;let{jsPDF:a,autoTable:e}=c,t=new a("p","mm","a4"),s=20;t.setFontSize(18),t.text("INVOICE SERVICE",105,s,{align:"center"}),s+=10,t.setFontSize(12),t.text(`Pelanggan: ${n.pelangganNama}`,20,s),s+=7,t.text(`Kendaraan: ${n.kendaraanLabel}`,20,s),s+=7,t.text(`Mekanik: ${n.mekanikNama}`,20,s),s+=7,t.text(`Jenis Servis: ${n.jenisServis.join(", ")}`,20,s),s+=7,t.text(`Status: ${n.status}`,20,s),s+=10,n.sparepart.length>0&&(e(t,{startY:s,head:[["Nama","Harga","Qty","Subtotal"]],body:n.sparepart.map(a=>[a.nama,`Rp ${a.harga.toLocaleString("id-ID")}`,a.qty,`Rp ${(a.harga*a.qty).toLocaleString("id-ID")}`]),theme:"grid",headStyles:{fillColor:[30,30,30],textColor:[255,255,255]},margin:{left:20,right:20}}),s=t.lastAutoTable.finalY+10),t.setFontSize(12),t.text(`Biaya Servis: Rp ${n.biayaServis.toLocaleString("id-ID")}`,20,s),s+=7,t.text(`Total Sparepart: Rp ${n.totalSparepart.toLocaleString("id-ID")}`,20,s),s+=10,t.setFontSize(14),t.text(`Total Bayar: Rp ${n.totalBayar.toLocaleString("id-ID")}`,20,s),t.save(`invoice-${n.id}.pdf`)},children:"Cetak PDF"})]})]})]})}a.s(["default",()=>i])},34162,a=>{a.v(e=>Promise.all(["static/chunks/ea4c8059a9d8541a.js","static/chunks/2b29c03dcc4d2e20.js"].map(e=>a.l(e))).then(()=>e(55749)))},98136,a=>{a.v(e=>Promise.all(["static/chunks/1b4c62f18aa2d6b2.js"].map(e=>a.l(e))).then(()=>e(45700)))}]);